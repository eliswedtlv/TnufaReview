<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TnufaReview - ×§×•×¤×™×™×œ×•×˜ ×œ×‘×§×©×ª ××¢× ×§ ×ª× ×•×¤×”</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
  <!-- GitHub buttons script -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Helvetica Neue', Arial, 'Noto Sans Hebrew', sans-serif;
      background: #f5f7fa;
      min-height: 100vh;
      padding: 0;
      direction: rtl;
    }
    
    .github-star-button {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 100;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px 40px 20px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 25px;
    }
    
    .header h1 {
      color: #2c3e50;
      font-size: 3.5em;
      margin-bottom: 8px;
      font-family: 'Montserrat', sans-serif;
      font-weight: 300;
      letter-spacing: -0.5px;
    }
    
    .header .slogan {
      color: #5a6c7d;
      font-size: 1.1em;
      margin-bottom: 35px;
      font-weight: 600;
    }
    
    .header p {
      color: #5a6c7d;
      font-size: 1.05em;
      line-height: 1.7;
      max-width: 750px;
      margin: 0 auto;
      font-weight: 400;
    }
    
    .upload-section {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
      margin-bottom: 30px;
      position: relative;
    }
    
    .upload-section h2 {
      color: #2c3e50;
      font-size: 1.2em;
      margin-bottom: 8px;
      text-align: center;
      font-weight: 600;
      line-height: 1.6;
    }
    
    .privacy-note {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
      margin-bottom: 25px;
      font-weight: 400;
    }
    
    .upload-area {
      border: 2px dashed #cbd5e0;
      border-radius: 12px;
      padding: 30px 30px;
      text-align: center;
      background: #fafbfc;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .upload-area:hover {
      border-color: #4a90e2;
      background: #f7fafc;
    }
    
    .upload-area.drag-over {
      border-color: #4a90e2;
      background: #eef6ff;
      border-style: solid;
    }
    
    .upload-icon {
      font-size: 2.5em;
      margin-bottom: 12px;
      color: #94a3b8;
    }
    
    .upload-text {
      color: #64748b;
      font-size: 1.05em;
      margin-bottom: 8px;
    }
    
    .upload-subtext {
      color: #94a3b8;
      font-size: 0.95em;
      margin-bottom: 0;
    }
    
    .credit-text {
      text-align: center;
      color: #64748b;
      font-size: 0.9em;
      margin-top: 20px;
      padding: 20px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
      font-weight: 400;
    }
    
    .credit-text a {
      color: #4a90e2;
      text-decoration: none;
      font-weight: 500;
    }
    
    .credit-text a:hover {
      text-decoration: underline;
    }
    
    .social-links {
      display: flex;
      gap: 15px;
      justify-content: center;
      align-items: center;
      margin-top: 10px;
    }
    
    .social-links a {
      color: #64748b;
      font-size: 1.3em;
      transition: all 0.2s ease;
      text-decoration: none;
    }
    
    .social-links a:hover {
      color: #4a90e2;
      transform: translateY(-2px);
    }
    
    input[type="file"] {
      display: none;
    }
    
    .file-label {
      display: inline-block;
      background: #4a90e2;
      color: white;
      padding: 14px 35px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      transition: all 0.2s ease;
      margin-top: 15px;
      font-weight: 500;
    }
    
    .file-label:hover {
      background: #357abd;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
    }
    
    .selected-file {
      margin-top: 20px;
      color: #10b981;
      font-weight: 500;
      display: none;
      font-size: 0.95em;
    }
    
    button {
      background: #4a90e2;
      color: white;
      border: none;
      padding: 14px 35px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      width: 100%;
      margin-top: 20px;
      transition: all 0.2s ease;
    }
    
    button:hover:not(:disabled) {
      background: #357abd;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
    }
    
    button:disabled {
      background: #cbd5e0;
      cursor: not-allowed;
      transform: none;
    }
    
    .loading-overlay {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      border-radius: 16px;
      z-index: 10;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }
    
    .loading-overlay.active {
      display: flex;
    }
    
    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid #e2e8f0;
      border-top: 4px solid #4a90e2;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 25px;
    }
    
    .loading-text {
      color: #5a6c7d;
      font-size: 1.1em;
      font-weight: 500;
      margin-bottom: 8px;
    }
    
    .loading-subtext {
      color: #94a3b8;
      font-size: 0.95em;
      margin-bottom: 20px;
    }
    
    .loading-warning {
      color: #dc2626;
      font-size: 1em;
      font-weight: 600;
      margin-top: 20px;
      padding: 12px 20px;
      background: #fee;
      border: 1px solid #fecaca;
      border-radius: 8px;
      max-width: 400px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading {
      display: none;
    }
    
    .message {
      margin-top: 20px;
      padding: 14px 18px;
      border-radius: 8px;
      display: none;
      text-align: center;
      font-weight: 500;
      font-size: 0.95em;
    }
    
    .error {
      background: #fee;
      color: #dc2626;
      border: 1px solid #fecaca;
    }
    
    .success {
      background: #d1fae5;
      color: #065f46;
      border: 1px solid #a7f3d0;
    }
    
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .modal-overlay.active {
      display: flex;
    }
    
    .modal-dialog {
      background: white;
      border-radius: 16px;
      padding: 35px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      max-width: 400px;
      text-align: center;
    }
    
    .modal-title {
      color: #dc2626;
      font-size: 1.3em;
      font-weight: 600;
      margin-bottom: 20px;
    }
    
    .modal-button {
      background: #4a90e2;
      color: white;
      border: none;
      padding: 12px 40px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      margin-top: 10px;
      transition: all 0.2s ease;
    }
    
    .modal-button:hover {
      background: #357abd;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
    }
    
    .result-container {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
      display: none;
      margin-top: 30px;
    }
    
    .result-container .header {
      margin-bottom: 5px;
    }
    
    .result-container .header h1 {
      margin-bottom: 5px;
      font-family: 'Montserrat', sans-serif;
      font-weight: 300;
    }
    
    .result-container .header .slogan {
      margin-bottom: 15px;
    }
    
    .result-container .header p {
      display: none;
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      margin-top: 15px;
    }
    
    .back-button {
      background: #64748b;
      color: white;
      border: none;
      padding: 10px 24px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 0.95em;
      width: auto;
      display: inline-block;
      transition: all 0.2s ease;
      font-weight: 500;
    }
    
    .back-button:hover {
      background: #475569;
      transform: translateY(-1px);
    }
    
    .copy-button {
      background: #4a90e2;
      color: white;
      border: none;
      padding: 10px 24px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 0.95em;
      width: auto;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s ease;
      font-weight: 500;
    }
    
    .copy-button:hover {
      background: #357abd;
      transform: translateY(-1px);
    }
    
    .copy-button.copied {
      background: #10b981;
    }
    
    .result-content {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 35px;
      direction: rtl;
      text-align: right;
      font-family: 'Helvetica Neue', Arial, 'Noto Sans Hebrew', sans-serif;
      font-size: 15px;
      line-height: 1.8;
      max-height: 70vh;
      overflow: auto;
      color: #1e293b;
    }
    
    .result-section {
      margin-bottom: 35px;
      padding-bottom: 25px;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .result-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .section-title {
      font-size: 1.4em;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 18px;
      padding-bottom: 12px;
      border-bottom: 3px solid #4a90e2;
      display: inline-block;
    }
    
    .field-label {
      font-weight: 700;
      color: #475569;
      font-size: 1.05em;
      margin-top: 16px;
      margin-bottom: 8px;
      display: block;
    }
    
    .field-value {
      color: #334155;
      text-align: justify;
      line-height: 1.8;
      margin-bottom: 12px;
      display: block;
    }
    
    .list-item {
      padding: 8px 0;
      padding-right: 20px;
      position: relative;
      color: #334155;
      text-align: justify;
    }
    
    .list-item:before {
      content: "â€¢";
      position: absolute;
      right: 0;
      color: #4a90e2;
      font-weight: bold;
      font-size: 1.2em;
    }
    
    .result-content::-webkit-scrollbar {
      width: 8px;
    }
    
    .result-content::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 4px;
    }
    
    .result-content::-webkit-scrollbar-thumb {
      background: #cbd5e0;
      border-radius: 4px;
    }
    
    .result-content::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
    
    @media (max-width: 768px) {
      .logo {
        top: 12px;
        right: 12px;
        font-size: 0.95em;
      }
      
      .logo-icon {
        width: 28px;
        height: 28px;
        font-size: 0.9em;
      }
      
      .container {
        padding: 50px 15px 30px 15px;
      }
      
      .header {
        margin-bottom: 20px;
      }
      
      .header h1 {
        font-size: 1.8em;
      }
      
      .header p {
        font-size: 0.95em;
      }
      
      .upload-section, .result-container {
        padding: 25px 20px;
      }
      
      .upload-area {
        padding: 35px 20px;
      }
      
      .upload-icon {
        font-size: 2.8em;
      }
      
      .result-header {
        flex-direction: column;
        gap: 10px;
        align-items: stretch;
      }
      
      .back-button, .copy-button {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- GitHub Star Button -->
  <div class="github-star-button">
    <a class="github-button" href="https://github.com/eliswedtlv/TnufaReview" data-color-scheme="no-preference: light; light: light; dark: dark;" data-size="large" data-show-count="true" aria-label="Star eliswedtlv/TnufaReview on GitHub">Star</a>
  </div>

  <div class="container">
    <!-- Header Section -->
    <div class="header">
      <h1>TnufaReview</h1>
      <div class="slogan">×§×•×¤×™×™×œ×•×˜ ×œ×‘×§×©×ª ××¢× ×§ ×ª× ×•×¤×”</div>
      <p>
        ××—×ª ×”×“×¨×›×™× ×”×™×¢×™×œ×•×ª ×‘×™×•×ª×¨ ×¢×‘×•×¨ ××™×–× ×©×™×© ×‘×• ×—×“×©× ×•×ª ×××©×™×ª ×œ×”×ª×§×“× ×”×™× ××¢× ×§ ×ª× ×•×¤×” - ××š ×”×˜×•×¤×¡ ×œ× ×¤×©×•×˜ ×•×¨×‘×™× ××ª×§×©×™× ×œ××œ××•. ×‘× ×™× ×• ××¢×¨×›×ª ××‘×•×¡×¡×ª AI ×©××¢×™×¨×” ×¢×œ ×”×˜×•×¤×¡ ×”××œ×, ×•×›×¤×™ ×©×ª×¨××• ×‘×¢×¦××›× ×™×•×“×¢×ª ××ª ××©×¨ ×œ×¤× ×™×”â€¦ ×× ×• ××ª××§×“×™× ×›×¨×’×¢ ×‘×—×œ×§×™× ×”×˜×§×¡×˜×•××œ×™×™× ×©×œ ×”×‘×§×©×”, ×‘×”××©×š × ×˜×¤×œ ×’× ×‘×¨×©×™××ª ×”××©×™××•×ª ×•×”×ª×§×¦×™×‘.
      </p>
    </div>

    <!-- Privacy Statement -->
    <p style="text-align: center; font-weight: 600; color: #2c3e50; margin: 0 auto 20px auto; font-size: 1.05em; line-height: 1.6; max-width: 750px;">
      × ×ª×•× ×™ ×”×˜×•×¤×¡ ×•×”×ª×©×•×‘×•×ª ××™× × × ×©××¨×™× ×›×œ×œ ×•×”×¢×™×‘×•×“ ××ª×‘×¦×¢ ×‘×–×™×›×¨×•×Ÿ ×‘×œ×‘×“, ×›×¤×™ ×©× ×™×ª×Ÿ ×œ×¨××•×ª ×‘×§×•×“ ×”×¤×ª×•×— ×©×œ ×”×¤×¨×•×™×§×˜ ×‘<a href="https://github.com/eliswedtlv/TnufaReview" target="_blank" style="color: #4a90e2; text-decoration: none; font-weight: 600;">GitHub</a>. × ×™×ª×Ÿ ×›××•×‘×Ÿ ×’× ×œ×™×¦×•×¨ Clone ×•×œ×”×¨×™×¥ ××§×•××™×ª.
    </p>

    <!-- Upload Section -->
    <div class="upload-section" id="uploadSection">
      <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
        <div class="upload-icon">ğŸ“„</div>
        <p class="upload-text">×’×¨×¨×• ×§×•×‘×¥ ×œ×›××Ÿ ××• ×œ×—×¦×• ×œ×‘×—×™×¨×”</p>
        <p class="upload-subtext">×˜×¤×¡×™ ×ª× ×•×¤×” ×‘×¤×•×¨××˜ DOCX ×‘×œ×‘×“</p>
        <input type="file" id="fileInput" name="file" accept=".docx" />
        <div class="selected-file" id="selectedFile"></div>
      </div>
      
      <button onclick="uploadFile()" id="uploadBtn" disabled>×”×¢×œ×• ×•×‘×“×§×•</button>
      
      <p class="privacy-note">×”×˜×•×¤×¡ ×•×”×ª×©×•×‘×” ××™× × × ×©××¨×™× ×‘×©×¨×ª</p>
      
      <!-- Loading Overlay -->
      <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">××¢×‘×“ ××ª ×”×§×•×‘×¥...</div>
        <div class="loading-subtext">×”×ª×”×œ×™×š ××•×¨×š ××¡×¤×¨ ×“×§×•×ª</div>
        <div class="loading-warning">âš ï¸ ×× × ××œ ×ª×¨×¢× × ×• ××ª ×”×“×£</div>
      </div>
      
      <div class="loading" id="loading">
        <div class="loading-content">
          ×”×ª×”×œ×™×š ××•×¨×š ××¡×¤×¨ ×“×§×•×ª
          <span class="spinner"></span>
        </div>
      </div>
      
      <div class="message error" id="error"></div>
      <div class="message success" id="success"></div>
    </div>
    
    <!-- Credit section - always visible -->
    <div class="credit-text">
      Eli Swed, CTO at <a href="https://tlvg.co" target="_blank">TLVG</a><br>
      Turnkey MVPs, POCs, IOT/XR, AI endpoints
      <div class="social-links">
        <a href="https://www.linkedin.com/in/eli-swed-664a122/" target="_blank" title="LinkedIn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
          </svg>
        </a>
        <a href="https://x.com/eliswed" target="_blank" title="Twitter/X">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
        <a href="https://github.com/eliswedtlv/" target="_blank" title="GitHub">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
          </svg>
        </a>
      </div>
    </div>

    <!-- Result Section -->
    <div class="result-container" id="resultContainer">
      <div class="header">
        <h1>TnufaReview</h1>
        <div class="slogan">×§×•×¤×™×™×œ×•×˜ ×œ×‘×§×©×ª ××¢× ×§ ×ª× ×•×¤×”</div>
      </div>
      <div class="result-header">
        <button class="back-button" onclick="goBack()">â† ×—×–×¨×”</button>
        <button class="copy-button" onclick="copyToClipboard()" id="copyBtn">
          <span id="copyIcon">ğŸ“‹</span>
          <span id="copyText">×”×¢×ª×§</span>
        </button>
      </div>
      <div class="result-content" id="resultContent"></div>
    </div>
  </div>

  <!-- Modal Dialog -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal-dialog">
      <div class="modal-title">×˜×¤×¡×™ ×ª× ×•×¤×” ×‘×œ×‘×“</div>
      <button class="modal-button" onclick="closeModal()">××™×©×•×¨</button>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');
    const uploadArea = document.getElementById('uploadArea');
    const selectedFile = document.getElementById('selectedFile');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const errorDiv = document.getElementById('error');
    const successDiv = document.getElementById('success');
    const uploadSection = document.getElementById('uploadSection');
    const resultContainer = document.getElementById('resultContainer');
    const resultContent = document.getElementById('resultContent');
    const loadingText = document.getElementById('loadingText');
    const modalOverlay = document.getElementById('modalOverlay');
    const mainHeader = document.querySelector('.container > .header');
    const creditSection = document.querySelector('.credit-text');
    
    // Rotating loading messages
    const loadingMessages = [
      '×”×˜×•×¤×¡ ×¢×œ×”, ××¢×‘×“×™× ××ª ×”× ×ª×•× ×™×...',
      '×× ×ª×—×™× ××ª ×”×ª×•×›×Ÿ...',
      '×‘×•×“×§×™× ×¢××™×“×” ×‘×“×¨×™×©×•×ª...',
      '××¢×¨×™×›×™× ××ª ××™×›×•×ª ×”×ª×©×•×‘×•×ª...',
      '×”×ª×”×œ×™×š ××•×¨×š ××¡×¤×¨ ×“×§×•×ª, ×”××ª×™× ×• ×‘×¡×‘×œ× ×•×ª...',
      '×›××¢×˜ ×¡×™×™×× ×•...'
    ];
    
    let messageIndex = 0;
    let messageInterval = null;
    
    function startLoadingMessages() {
      messageIndex = 0;
      loadingText.textContent = loadingMessages[0];
      
      messageInterval = setInterval(() => {
        messageIndex = (messageIndex + 1) % loadingMessages.length;
        loadingText.textContent = loadingMessages[messageIndex];
      }, 15000); // Change every 15 seconds
    }
    
    function stopLoadingMessages() {
      if (messageInterval) {
        clearInterval(messageInterval);
        messageInterval = null;
      }
    }
    
    // File selection handling
    fileInput.addEventListener('change', function() {
      if (this.files && this.files[0]) {
        selectedFile.textContent = `âœ“ × ×‘×—×¨: ${this.files[0].name}`;
        selectedFile.style.display = 'block';
        uploadBtn.disabled = false;
      } else {
        selectedFile.style.display = 'none';
        uploadBtn.disabled = true;
      }
    });
    
    // Drag and drop functionality
    uploadArea.addEventListener('dragover', function(e) {
      e.preventDefault();
      this.classList.add('drag-over');
    });
    
    uploadArea.addEventListener('dragleave', function(e) {
      e.preventDefault();
      this.classList.remove('drag-over');
    });
    
    uploadArea.addEventListener('drop', function(e) {
      e.preventDefault();
      this.classList.remove('drag-over');
      
      if (e.dataTransfer.files && e.dataTransfer.files[0]) {
        const file = e.dataTransfer.files[0];
        if (file.name.endsWith('.docx')) {
          fileInput.files = e.dataTransfer.files;
          selectedFile.textContent = `âœ“ × ×‘×—×¨: ${file.name}`;
          selectedFile.style.display = 'block';
          uploadBtn.disabled = false;
        } else {
          showError('×× × ×‘×—×¨ ×§×•×‘×¥ DOCX ×‘×œ×‘×“');
        }
      }
    });
    
    // Helper function to show error
    function showError(message) {
      // Check if it's a Tnufa form validation error
      if (message.includes('must be a .docx Tnufa application form') || 
          message.includes('does not look like a Tnufa application form')) {
        showTnufaErrorModal();
        return;
      }
      
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
      successDiv.style.display = 'none';
      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 5000);
    }
    
    // Show Tnufa error modal
    function showTnufaErrorModal() {
      modalOverlay.classList.add('active');
    }
    
    // Close modal and reset form
    function closeModal() {
      modalOverlay.classList.remove('active');
      // Reset form
      fileInput.value = '';
      selectedFile.style.display = 'none';
      uploadBtn.disabled = true;
    }
    
    // Helper function to show success
    function showSuccess(message) {
      successDiv.textContent = message;
      successDiv.style.display = 'block';
      errorDiv.style.display = 'none';
    }
    
    // Copy to clipboard function
    function copyToClipboard() {
      const textToCopy = resultContent.innerText || resultContent.textContent;
      const copyBtn = document.getElementById('copyBtn');
      const copyText = document.getElementById('copyText');
      
      navigator.clipboard.writeText(textToCopy).then(() => {
        copyBtn.classList.add('copied');
        copyText.textContent = '×”×•×¢×ª×§!';
        setTimeout(() => {
          copyBtn.classList.remove('copied');
          copyText.textContent = '×”×¢×ª×§';
        }, 2000);
      }).catch(err => {
        console.error('Failed to copy:', err);
      });
    }
    
    // Prettify JSON to beautiful HTML
    function prettifyJSON(data) {
      let html = '';
      
      // Map ALL possible keys to Hebrew titles - EXACT official Tnufa order
      const hebrewTitles = {
        'executive_summary': '×¡×™×›×•× ×× ×”×œ×™×',
        'Executive Summary': '×¡×™×›×•× ×× ×”×œ×™×',
        'the_need': '×”×¦×•×¨×š',
        'The Need': '×”×¦×•×¨×š',
        'the_product': '×”××•×¦×¨',
        'The Product': '×”××•×¦×¨',
        'product': '×”××•×¦×¨',
        'Product': '×”××•×¦×¨',
        'team_and_capabilities': '×”×¦×•×•×ª ×•×™×›×•×œ×•×ª ×”××™×–×, ×¤×¢×¨×™× ×‘×™×›×•×œ×•×ª',
        'Team And Capabilities': '×”×¦×•×•×ª ×•×™×›×•×œ×•×ª ×”××™×–×, ×¤×¢×¨×™× ×‘×™×›×•×œ×•×ª',
        'team': '×”×¦×•×•×ª ×•×™×›×•×œ×•×ª ×”××™×–×, ×¤×¢×¨×™× ×‘×™×›×•×œ×•×ª',
        'Team': '×”×¦×•×•×ª ×•×™×›×•×œ×•×ª ×”××™×–×, ×¤×¢×¨×™× ×‘×™×›×•×œ×•×ª',
        'intellectual_property': '×§× ×™×™×Ÿ ×¨×•×—× ×™',
        'Intellectual Property': '×§× ×™×™×Ÿ ×¨×•×—× ×™',
        'technology_uniqueness_innovation': '×”×˜×›× ×•×œ×•×’×™×”, ×™×™×—×•×“×™×•×ª ×•×—×“×©× ×•×ª, ×—×¡××™ ×›× ×™×¡×” ×˜×›× ×•×œ×•×’×™×™×, ××ª×’×¨×™×, ××•×¦×¨×™ ×¦×“ ×’\'',
        'Technology Uniqueness Innovation': '×”×˜×›× ×•×œ×•×’×™×”, ×™×™×—×•×“×™×•×ª ×•×—×“×©× ×•×ª, ×—×¡××™ ×›× ×™×¡×” ×˜×›× ×•×œ×•×’×™×™×, ××ª×’×¨×™×, ××•×¦×¨×™ ×¦×“ ×’\'',
        'technology_and_innovation': '×”×˜×›× ×•×œ×•×’×™×”, ×™×™×—×•×“×™×•×ª ×•×—×“×©× ×•×ª, ×—×¡××™ ×›× ×™×¡×” ×˜×›× ×•×œ×•×’×™×™×, ××ª×’×¨×™×, ××•×¦×¨×™ ×¦×“ ×’\'',
        'Technology And Innovation': '×”×˜×›× ×•×œ×•×’×™×”, ×™×™×—×•×“×™×•×ª ×•×—×“×©× ×•×ª, ×—×¡××™ ×›× ×™×¡×” ×˜×›× ×•×œ×•×’×™×™×, ××ª×’×¨×™×, ××•×¦×¨×™ ×¦×“ ×’\'',
        'tasks_and_activities': '××©×™××•×ª ×•×¤×¢×™×œ×•×™×•×ª ×‘××™×–× ×–×”',
        'Tasks And Activities': '××©×™××•×ª ×•×¤×¢×™×œ×•×™×•×ª ×‘××™×–× ×–×”',
        'work_plan': '××©×™××•×ª ×•×¤×¢×™×œ×•×™×•×ª ×‘××™×–× ×–×”',
        'Work Plan': '××©×™××•×ª ×•×¤×¢×™×œ×•×™×•×ª ×‘××™×–× ×–×”',
        'market_clients_competition_business_model': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'Market Clients Competition Business Model': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'opportunities_and_market_capabilities': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'Opportunities And Market Capabilities': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'business_model': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'Business Model': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'competition': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'Competition': '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        'grant_contribution_to_success': '×ª×¨×•××ª ××¢× ×§ ×ª× ×•×¤×” ×œ×”×¦×œ×—×ª ×”××™×–×',
        'Grant Contribution To Success': '×ª×¨×•××ª ××¢× ×§ ×ª× ×•×¤×” ×œ×”×¦×œ×—×ª ×”××™×–×',
        'royalties': '×ª××œ×•×’×™×',
        'Royalties': '×ª××œ×•×’×™×',
        'economic_and_technological_contribution': '×”×ª×¨×•××” ×”×˜×›× ×•×œ×•×’×™×ª ×•×”×ª×¢×¡×•×§×ª×™×ª ×”×¦×¤×•×™×” ×©×œ ×”××™×–× ×œ×›×œ×›×œ×” ×”×™×©×¨××œ×™×ª',
        'Economic And Technological Contribution': '×”×ª×¨×•××” ×”×˜×›× ×•×œ×•×’×™×ª ×•×”×ª×¢×¡×•×§×ª×™×ª ×”×¦×¤×•×™×” ×©×œ ×”××™×–× ×œ×›×œ×›×œ×” ×”×™×©×¨××œ×™×ª',
        'budget': '×”×ª×§×¦×™×‘',
        'Budget': '×”×ª×§×¦×™×‘'
      };
      
      // EXACT display order from official Tnufa form
      const displayOrder = [
        '×¡×™×›×•× ×× ×”×œ×™×',
        '×”×¦×•×¨×š',
        '×”××•×¦×¨',
        '×”×¦×•×•×ª ×•×™×›×•×œ×•×ª ×”××™×–×, ×¤×¢×¨×™× ×‘×™×›×•×œ×•×ª',
        '×§× ×™×™×Ÿ ×¨×•×—× ×™',
        '×”×˜×›× ×•×œ×•×’×™×”, ×™×™×—×•×“×™×•×ª ×•×—×“×©× ×•×ª, ×—×¡××™ ×›× ×™×¡×” ×˜×›× ×•×œ×•×’×™×™×, ××ª×’×¨×™×, ××•×¦×¨×™ ×¦×“ ×’\'',
        '××©×™××•×ª ×•×¤×¢×™×œ×•×™×•×ª ×‘××™×–× ×–×”',
        '×©×•×§, ×œ×§×•×—×•×ª, ×ª×—×¨×•×ª ×•××•×“×œ ×¢×¡×§×™',
        '×ª×¨×•××ª ××¢× ×§ ×ª× ×•×¤×” ×œ×”×¦×œ×—×ª ×”××™×–×',
        '×ª××œ×•×’×™×',
        '×”×ª×¨×•××” ×”×˜×›× ×•×œ×•×’×™×ª ×•×”×ª×¢×¡×•×§×ª×™×ª ×”×¦×¤×•×™×” ×©×œ ×”××™×–× ×œ×›×œ×›×œ×” ×”×™×©×¨××œ×™×ª'
      ];
      
      const fieldLabels = {
        'response': '×ª×©×•×‘×”',
        'Response': '×ª×©×•×‘×”',
        'recommendation': '×”××œ×¦×”',
        'Recommendation': '×”××œ×¦×”',
        'recommendations': '×”××œ×¦×•×ª',
        'Recommendations': '×”××œ×¦×•×ª',
        'items': '×¤×¨×™×˜×™×',
        'Items': '×¤×¨×™×˜×™×',
        'description': '×ª×™××•×¨',
        'Description': '×ª×™××•×¨',
        'details': '×¤×¨×˜×™×',
        'Details': '×¤×¨×˜×™×'
      };
      
      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
      
      function formatValue(value) {
        if (value === null || value === undefined) {
          return '<span style="color: #94a3b8;">××™×Ÿ ××™×“×¢</span>';
        }
        
        if (typeof value === 'string') {
          return escapeHtml(value);
        }
        
        if (typeof value === 'number' || typeof value === 'boolean') {
          return escapeHtml(String(value));
        }
        
        if (Array.isArray(value)) {
          if (value.length === 0) return '<span style="color: #94a3b8;">××™×Ÿ × ×ª×•× ×™×</span>';
          return value.map((item, i) => 
            `<div class="list-item">${formatValue(item)}</div>`
          ).join('');
        }
        
        if (typeof value === 'object') {
          let result = '<div style="margin-right: 20px;">';
          for (const [k, v] of Object.entries(value)) {
            const displayKey = fieldLabels[k] || k;
            result += `<span class="field-label">${displayKey}</span>`;
            result += `<div class="field-value">${formatValue(v)}</div>`;
          }
          result += '</div>';
          return result;
        }
        
        return escapeHtml(String(value));
      }
      
      function processSection(key, value, hebrewTitle) {
        html += '<div class="result-section">';
        html += `<div class="section-title">${hebrewTitle}</div>`;
        
        if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
          for (const [fieldKey, fieldValue] of Object.entries(value)) {
            const fieldLabel = fieldLabels[fieldKey] || fieldKey;
            html += `<span class="field-label">${fieldLabel}</span>`;
            html += `<div class="field-value">${formatValue(fieldValue)}</div>`;
          }
        } else {
          html += `<div class="field-value">${formatValue(value)}</div>`;
        }
        
        html += '</div>';
      }
      
      // Create a map of data by Hebrew title
      const dataByHebrewTitle = new Map();
      for (const [key, value] of Object.entries(data)) {
        const hebrewTitle = hebrewTitles[key];
        if (hebrewTitle) {
          dataByHebrewTitle.set(hebrewTitle, { key, value });
        }
      }
      
      // Process sections in the specified order
      for (const hebrewTitle of displayOrder) {
        const entry = dataByHebrewTitle.get(hebrewTitle);
        if (entry) {
          processSection(entry.key, entry.value, hebrewTitle);
        }
      }
      
      // Process any remaining sections not in the order list
      for (const [key, value] of Object.entries(data)) {
        const hebrewTitle = hebrewTitles[key];
        if (hebrewTitle && !displayOrder.includes(hebrewTitle)) {
          processSection(key, value, hebrewTitle);
        } else if (!hebrewTitle) {
          // Fallback for unknown keys
          processSection(key, value, key);
        }
      }
      
      return html;
    }
    
    // Upload file function
    async function uploadFile() {
      errorDiv.style.display = 'none';
      successDiv.style.display = 'none';
      
      if (!fileInput.files || !fileInput.files[0]) {
        showError('×× × ×‘×—×¨ ×§×•×‘×¥ DOCX');
        return;
      }
      
      const file = fileInput.files[0];
      const formData = new FormData();
      formData.append('file', file);
      
      uploadBtn.disabled = true;
      loadingOverlay.classList.add('active');
      startLoadingMessages();
      
      try {
        const response = await fetch('https://web-production-17375.up.railway.app/review', {
          method: 'POST',
          body: formData
        });
        
        let data;
        try {
          data = await response.json();
        } catch (e) {
          throw new Error('×”×©×¨×ª ×”×—×–×™×¨ ×ª×©×•×‘×” ×œ× ×ª×§×™× ×”');
        }
        
        if (response.ok) {
          // Show result screen
          uploadSection.style.display = 'none';
          resultContainer.style.display = 'block';
          mainHeader.style.display = 'none';
          creditSection.style.display = 'none';
          resultContent.innerHTML = prettifyJSON(data);
          
          // Scroll window and result content to top after DOM updates
          setTimeout(() => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            resultContent.scrollTop = 0;
          }, 100);
        } else {
          // Pass the error message directly to showError
          const errorMessage = data.message || data.error || 'Unknown error';
          showError(errorMessage);
        }
      } catch (error) {
        showError(`×©×’×™××” ×‘×”×ª×—×‘×¨×•×ª ×œ×©×¨×ª: ${error.message}`);
      } finally {
        stopLoadingMessages();
        uploadBtn.disabled = false;
        loadingOverlay.classList.remove('active');
      }
    }
    
    // Go back function
    function goBack() {
      resultContainer.style.display = 'none';
      uploadSection.style.display = 'block';
      mainHeader.style.display = 'block';
      creditSection.style.display = 'block';
      
      // Reset form
      fileInput.value = '';
      selectedFile.style.display = 'none';
      uploadBtn.disabled = true;
      errorDiv.style.display = 'none';
      successDiv.style.display = 'none';
      
      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // Enter key support
    fileInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !uploadBtn.disabled) {
        uploadFile();
      }
    });
  </script>
</body>
</html>
